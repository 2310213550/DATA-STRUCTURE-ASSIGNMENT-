#include <stdio.h>
#include <stdlib.h>

/* Structure of Doubly Linked List */
struct node {
    int data;
    struct node *prev;
    struct node *next;
};

/* Create New Node */
struct node* createNode(int data) {
    struct node* newnode = (struct node*)malloc(sizeof(struct node));
    newnode->data = data;
    newnode->prev = NULL;
    newnode->next = NULL;
    return newnode;
}

/* Insert at End */
struct node* insertEnd(struct node* head, int data) {
    struct node* newnode = createNode(data);
    struct node* temp = head;

    if (head == NULL)
        return newnode;

    while (temp->next != NULL)
        temp = temp->next;

    temp->next = newnode;
    newnode->prev = temp;

    return head;
}

/* Forward Traversal */
void traverseForward(struct node* head) {
    struct node* temp = head;
    printf("Forward Traversal: ");
    while (temp != NULL) {
        printf("%d ", temp->data);
        temp = temp->next;
    }
    printf("\n");
}

/* Backward Traversal */
void traverseBackward(struct node* head) {
    struct node* temp = head;
    if (temp == NULL)
        return;

    while (temp->next != NULL)
        temp = temp->next;

    printf("Backward Traversal: ");
    while (temp != NULL) {
        printf("%d ", temp->data);
        temp = temp->prev;
    }
    printf("\n");
}

/* Delete Node by Value */
struct node* deleteValue(struct node* head, int key) {
    struct node* temp = head;

    while (temp != NULL && temp->data != key)
        temp = temp->next;

    if (temp == NULL) {
        printf("Element not found\n");
        return head;
    }

    if (temp->prev != NULL)
        temp->prev->next = temp->next;
    else
        head = temp->next;

    if (temp->next != NULL)
        temp->next->prev = temp->prev;

    free(temp);
    return head;
}

/* Interleave Two Doubly Linked Lists */
struct node* interleave(struct node* h1, struct node* h2) {
    struct node* head = NULL;
    struct node* tail = NULL;

    while (h1 != NULL || h2 != NULL) {

        if (h1 != NULL) {
            struct node* n = createNode(h1->data);
            if (head == NULL)
                head = tail = n;
            else {
                tail->next = n;
                n->prev = tail;
                tail = n;
            }
            h1 = h1->next;
        }

        if (h2 != NULL) {
            struct node* n = createNode(h2->data);
            tail->next = n;
            n->prev = tail;
            tail = n;
            h2 = h2->next;
        }
    }
    return head;
}

/* Main Function */
int main() {
    struct node *list1 = NULL, *list2 = NULL, *merged = NULL;

    /* Creating First List */
    list1 = insertEnd(list1, 1);
    list1 = insertEnd(list1, 3);
    list1 = insertEnd(list1, 5);

    /* Creating Second List */
    list2 = insertEnd(list2, 2);
    list2 = insertEnd(list2, 4);
    list2 = insertEnd(list2, 6);

    /* Display Lists */
    printf("List 1:\n");
    traverseForward(list1);

    printf("List 2:\n");
    traverseForward(list2);

    /* Interleaving Lists */
    merged = interleave(list1, list2);
    printf("Interleaved List:\n");
    traverseForward(merged);
    traverseBackward(merged);

    /* Deleting an Element */
    merged = deleteValue(merged, 4);
    printf("After Deleting 4:\n");
    traverseForward(merged);

    return 0;
}
